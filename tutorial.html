<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Chart Tutorial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        neon: {
                            green: '#00ff88',
                            cyan: '#00d4ff',
                            magenta: '#ff00ff',
                            orange: '#ffaa00',
                        },
                        dark: {
                            900: '#0a0a1a',
                            800: '#12122a',
                            700: '#1a1a3a',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }

        .glow-text {
            text-shadow: 0 0 20px currentColor;
        }

        .glow-box {
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
        }

        .code-block {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1a 100%);
            border: 1px solid rgba(255,255,255,0.1);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse-glow {
            0%, 100% { filter: drop-shadow(0 0 5px currentColor); }
            50% { filter: drop-shadow(0 0 20px currentColor); }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .animate-pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        .step-appear {
            animation: stepAppear 0.5s ease-out forwards;
        }

        @keyframes stepAppear {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        pre code {
            font-family: 'Monaco', 'Menlo', monospace;
        }

        .highlight-keyword { color: #ff79c6; }
        .highlight-string { color: #f1fa8c; }
        .highlight-number { color: #bd93f9; }
        .highlight-comment { color: #6272a4; }
        .highlight-function { color: #50fa7b; }
    </style>
</head>
<body class="text-white min-h-screen" style="background: radial-gradient(ellipse at center, #0a0a1a 0%, #000000 70%);">
    <div x-data="tutorial()" x-init="init()" class="relative">
        <!-- Floating Particles Background -->
        <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
            <template x-for="i in 30" :key="i">
                <div
                    class="absolute w-1 h-1 rounded-full animate-float"
                    :style="`
                        left: ${Math.random() * 100}%;
                        top: ${Math.random() * 100}%;
                        background: ${['#00ff88', '#00d4ff', '#ff00ff', '#ffaa00'][i % 4]};
                        box-shadow: 0 0 10px ${['#00ff88', '#00d4ff', '#ff00ff', '#ffaa00'][i % 4]};
                        animation-delay: ${Math.random() * 3}s;
                        animation-duration: ${3 + Math.random() * 3}s;
                    `"
                ></div>
            </template>
        </div>

        <!-- Header -->
        <header class="relative z-10 py-12 text-center border-b border-white/10">
            <h1 class="text-4xl font-light tracking-widest uppercase text-neon-cyan glow-text mb-4">
                Neon Chart Tutorial
            </h1>
            <p class="text-white/60 text-lg">How to create glowing dot-filled charts with vanilla SVG</p>
        </header>

        <!-- Navigation -->
        <nav class="sticky top-0 z-20 bg-dark-900/90 backdrop-blur-lg border-b border-white/10 py-4">
            <div class="max-w-6xl mx-auto px-6 flex gap-4 justify-center flex-wrap">
                <template x-for="(section, index) in sections" :key="index">
                    <button
                        @click="currentSection = index; currentStep = 0"
                        :class="currentSection === index ? 'bg-neon-cyan/20 text-neon-cyan border-neon-cyan' : 'bg-white/5 text-white/60 border-white/10 hover:border-white/30'"
                        class="px-6 py-2 rounded-full border transition-all duration-300 text-sm uppercase tracking-wider"
                        x-text="section.title"
                    ></button>
                </template>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="relative z-10 max-w-6xl mx-auto px-6 py-12">
            <!-- Section: Full Preview -->
            <section x-show="currentSection === 0" x-cloak class="step-appear">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-light text-neon-cyan glow-text mb-8 text-center">Full Chart Preview</h2>
                    <p class="text-white/50 text-center mb-12">No step gating â€” all layers rendered at once to verify the neon look.</p>

                    <div class="grid md:grid-cols-2 gap-12 items-start">
                        <!-- Radial chart -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 glow-box">
                            <div class="text-center text-white/40 text-xs uppercase tracking-[0.35em]">5-hour window</div>
                            <div class="mt-4 flex justify-center" x-html="fullPreviewSvg"></div>
                            <div class="mt-2 text-center text-white/30 text-xs">Resets in 1h 36m</div>
                        </div>

                        <!-- Side-by-side comparison note -->
                        <div class="space-y-8">
                            <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                                <h3 class="text-neon-green text-sm uppercase tracking-widest mb-4">Rendering Layers</h3>
                                <div class="space-y-3 text-sm">
                                    <div class="flex items-center gap-3">
                                        <div class="w-3 h-3 rounded-full bg-white/10"></div>
                                        <span class="text-white/60">Background dots (r=1.5, opacity 0.08)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="w-3 h-3 rounded-full bg-neon-cyan"></div>
                                        <span class="text-white/60">Core dot (0.9x size, variable opacity)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="w-3 h-3 rounded-full bg-neon-cyan/60"></div>
                                        <span class="text-white/60">Inner glow (1x size, 4px shadow)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="w-3 h-3 rounded-full bg-neon-cyan/20"></div>
                                        <span class="text-white/60">Outer bloom (1.1x size, 12px shadow)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="w-2 h-0.5 bg-neon-cyan/60"></div>
                                        <span class="text-white/60">Arc + glow filter (1.5px stroke)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <div class="w-2 h-0.5 bg-neon-cyan/30"></div>
                                        <span class="text-white/60">Radial end lines</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                                <h3 class="text-neon-green text-sm uppercase tracking-widest mb-4">Parameters</h3>
                                <div class="space-y-2 text-sm font-mono text-white/60">
                                    <p>outerRadius: <span class="text-neon-cyan">125</span></p>
                                    <p>innerRadius: <span class="text-neon-cyan">95</span></p>
                                    <p>ring width: <span class="text-neon-cyan">30px</span></p>
                                    <p>dotSpacing: <span class="text-neon-cyan">7</span></p>
                                    <p>dotSize: <span class="text-neon-cyan">1.5 + random * 0.6</span></p>
                                    <p>dotOpacity: <span class="text-neon-cyan">0.4 + random * 0.5</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Full Preview (Interactive) -->
            <section x-show="currentSection === 1" x-cloak class="step-appear">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-light text-neon-cyan glow-text mb-8 text-center">Full Preview (Interactive)</h2>
                    <p class="text-white/50 text-center mb-12">Real-time slider control with neon-style dots.</p>

                    <div class="grid md:grid-cols-2 gap-12 items-start">
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 glow-box">
                            <div class="text-center text-white/40 text-xs uppercase tracking-[0.35em]">5-hour window</div>
                            <div class="mt-4 flex justify-center" x-html="interactivePreviewSvg"></div>
                            <div class="mt-2 text-center text-white/30 text-xs">Resets in 1h 36m</div>

                            <div class="mt-8">
                                <label class="text-white/50 text-sm mb-2 block">Adjust fill:</label>
                                <input type="range" min="0" max="100" step="1" x-model.number="interactivePreviewPercent" @input="updateInteractivePreview()" class="w-full accent-neon-cyan">
                            </div>
                        </div>

                        <div class="space-y-8">
                            <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                                <h3 class="text-neon-green text-sm uppercase tracking-widest mb-4">Render Notes</h3>
                                <div class="space-y-3 text-sm text-white/60">
                                    <p>Uses the same dot placement and arc math as the neon page.</p>
                                    <p>Dots are deterministic per position so the pattern stays stable as you drag.</p>
                                    <p>Slider updates the SVG in real time.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Radial Chart -->
            <section x-show="currentSection === 2" x-cloak class="step-appear">
                <div class="grid lg:grid-cols-2 gap-12 items-start">
                    <!-- Live Preview -->
                    <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 glow-box sticky top-24">
                        <h3 class="text-neon-green text-sm uppercase tracking-widest mb-6">Live Preview</h3>
                        <div class="flex justify-center" x-html="radialPreviewSvg"></div>

                        <!-- Progress slider -->
                        <div class="mt-8" x-show="radialStep >= 3">
                            <label class="text-white/50 text-sm mb-2 block">Adjust fill percentage:</label>
                            <input type="range" min="0" max="1" step="0.01" x-model="radialProgress" @input="updateRadialPreview()" class="w-full accent-neon-cyan">
                        </div>
                    </div>

                    <!-- Steps -->
                    <div class="space-y-6">
                        <h2 class="text-2xl font-light text-neon-cyan glow-text">Building the Radial Chart</h2>

                        <!-- Step 1 -->
                        <div
                            @click="radialStep = Math.max(radialStep, 1); updateRadialPreview()"
                            :class="radialStep >= 1 ? 'border-neon-cyan/50 bg-neon-cyan/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all duration-300 hover:border-neon-cyan/30"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-cyan/20 text-neon-cyan flex items-center justify-center text-sm">1</span>
                                <h3 class="text-lg">Draw Grid Lines & Labels</h3>
                            </div>
                            <p class="text-white/60 mb-4">Render guide rings and axis lines with percentage labels.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="radialStep >= 1">
<pre><code><span class="highlight-comment">// Subtle guide rings + axis lines</span>
<span class="highlight-keyword">svg</span> += <span class="highlight-string">`&lt;circle ... stroke="rgba(255,255,255,0.08)"/&gt;`</span>;
<span class="highlight-keyword">svg</span> += <span class="highlight-string">`&lt;line ... stroke="rgba(255,255,255,0.05)"/&gt;`</span>;
<span class="highlight-keyword">svg</span> += <span class="highlight-string">`&lt;text ...&gt;25%&lt;/text&gt;`</span>;</code></pre>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div
                            @click="radialStep = Math.max(radialStep, 2); updateRadialPreview()"
                            :class="radialStep >= 2 ? 'border-neon-green/50 bg-neon-green/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all duration-300 hover:border-neon-green/30"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-green/20 text-neon-green flex items-center justify-center text-sm">2</span>
                                <h3 class="text-lg">Create Background Dot Grid</h3>
                            </div>
                            <p class="text-white/60 mb-4">Generate dots in concentric rings using polar coordinates, then add a soft ambient glow.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="radialStep >= 2">
<pre><code><span class="highlight-comment">// Generate dots for each radius ring</span>
<span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> r = innerRadius; r < outerRadius; r += dotSpacing) {
  <span class="highlight-keyword">const</span> circumference = <span class="highlight-number">2</span> * Math.PI * r;
  <span class="highlight-keyword">const</span> angleStep = (dotSpacing / circumference) * <span class="highlight-number">360</span>;

  <span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> angle = <span class="highlight-number">-90</span>; angle < <span class="highlight-number">270</span>; angle += angleStep) {
    <span class="highlight-keyword">const</span> rad = angle * Math.PI / <span class="highlight-number">180</span>;
    <span class="highlight-keyword">const</span> x = centerX + r * Math.<span class="highlight-function">cos</span>(rad);
    <span class="highlight-keyword">const</span> y = centerY + r * Math.<span class="highlight-function">sin</span>(rad);
    <span class="highlight-comment">// Create dot at (x, y)</span>
  }
}</code></pre>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div
                            @click="radialStep = Math.max(radialStep, 3); updateRadialPreview()"
                            :class="radialStep >= 3 ? 'border-neon-magenta/50 bg-neon-magenta/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all duration-300 hover:border-neon-magenta/30"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-magenta/20 text-neon-magenta flex items-center justify-center text-sm">3</span>
                                <h3 class="text-lg">Fill Dots Based on Percentage</h3>
                            </div>
                            <p class="text-white/60 mb-4">Color dots within the fill angle with deterministic noise for stable depth.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="radialStep >= 3">
<pre><code><span class="highlight-keyword">const</span> fillEndAngle = <span class="highlight-number">-90</span> + (percent / <span class="highlight-number">100</span>) * <span class="highlight-number">360</span>;

<span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> angle = <span class="highlight-number">-90</span>; angle < fillEndAngle; angle += step) {
  <span class="highlight-keyword">const</span> opacity = <span class="highlight-number">0.4</span> + noise(r, angle) * <span class="highlight-number">0.5</span>;
  <span class="highlight-keyword">const</span> size = <span class="highlight-number">1.5</span> + noise(angle, r) * <span class="highlight-number">0.6</span>;

  svg += <span class="highlight-string">`&lt;circle cx="\${x}" cy="\${y}"
    r="\${size}" fill="\${color}"
    opacity="\${opacity}"
    style="filter: drop-shadow(0 0 2px \${color})"/&gt;`</span>;
}</code></pre>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div
                            @click="radialStep = Math.max(radialStep, 4); updateRadialPreview()"
                            :class="radialStep >= 4 ? 'border-neon-orange/50 bg-neon-orange/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all duration-300 hover:border-neon-orange/30"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-orange/20 text-neon-orange flex items-center justify-center text-sm">4</span>
                                <h3 class="text-lg">Add Glowing Arc Outlines</h3>
                            </div>
                            <p class="text-white/60 mb-4">Draw SVG arcs with blur filter for the neon glow effect.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="radialStep >= 4">
<pre><code><span class="highlight-comment">// SVG arc path formula</span>
<span class="highlight-keyword">const</span> startX = cx + radius * Math.<span class="highlight-function">cos</span>(startRad);
<span class="highlight-keyword">const</span> startY = cy + radius * Math.<span class="highlight-function">sin</span>(startRad);
<span class="highlight-keyword">const</span> endX = cx + radius * Math.<span class="highlight-function">cos</span>(endRad);
<span class="highlight-keyword">const</span> endY = cy + radius * Math.<span class="highlight-function">sin</span>(endRad);
<span class="highlight-keyword">const</span> largeArc = percent > <span class="highlight-number">50</span> ? <span class="highlight-number">1</span> : <span class="highlight-number">0</span>;

<span class="highlight-keyword">const</span> path = <span class="highlight-string">`M \${startX} \${startY}
  A \${radius} \${radius} 0 \${largeArc} 1 \${endX} \${endY}`</span>;

<span class="highlight-comment">// Apply glow filter</span>
<span class="highlight-string">`&lt;path d="\${path}" filter="url(#glow)"/&gt;`</span></code></pre>
                            </div>
                        </div>

                        <!-- Step 5 -->
                        <div
                            @click="radialStep = Math.max(radialStep, 5); updateRadialPreview()"
                            :class="radialStep >= 5 ? 'border-neon-orange/50 bg-neon-orange/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all duration-300 hover:border-neon-orange/30"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-orange/20 text-neon-orange flex items-center justify-center text-sm">5</span>
                                <h3 class="text-lg">Add Center Text with Glow</h3>
                            </div>
                            <p class="text-white/60 mb-4">Use text-shadow for the neon text effect.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="radialStep >= 5">
<pre><code><span class="highlight-string">`&lt;text x="\${centerX}" y="\${centerY}"
  text-anchor="middle"
  fill="#ffffff"
  font-size="32"
  style="text-shadow: 0 0 15px \${color}80;"&gt;
  \${percent}%
&lt;/text&gt;`</span></code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Bar Chart -->
            <section x-show="currentSection === 3" x-cloak class="step-appear">
                <div class="grid lg:grid-cols-2 gap-12 items-start">
                    <!-- Live Preview -->
                    <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 glow-box sticky top-24">
                        <h3 class="text-neon-green text-sm uppercase tracking-widest mb-6">Live Preview</h3>
                        <div x-html="barPreviewSvg"></div>

                        <div class="mt-8" x-show="barStep >= 3">
                            <label class="text-white/50 text-sm mb-2 block">Animation progress:</label>
                            <input type="range" min="0" max="1" step="0.01" x-model="barProgress" @input="updateBarPreview()" class="w-full accent-neon-cyan">
                        </div>
                    </div>

                    <!-- Steps -->
                    <div class="space-y-6">
                        <h2 class="text-2xl font-light text-neon-cyan glow-text">Building the Bar Chart</h2>

                        <div
                            @click="barStep = Math.max(barStep, 1); updateBarPreview()"
                            :class="barStep >= 1 ? 'border-neon-cyan/50 bg-neon-cyan/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-cyan/20 text-neon-cyan flex items-center justify-center text-sm">1</span>
                                <h3 class="text-lg">Draw Grid Lines & Labels</h3>
                            </div>
                            <p class="text-white/60 mb-4">Create percentage scale from 0-100%.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="barStep >= 1">
<pre><code><span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> i = <span class="highlight-number">0</span>; i <= <span class="highlight-number">10</span>; i++) {
  <span class="highlight-keyword">const</span> x = startX + (i / <span class="highlight-number">10</span>) * chartWidth;
  svg += <span class="highlight-string">`&lt;line x1="\${x}" y1="20"
    x2="\${x}" y2="\${height-40}"
    stroke="rgba(255,255,255,0.05)"/&gt;`</span>;
  svg += <span class="highlight-string">`&lt;text x="\${x}" y="\${height-15}"&gt;
    \${i * 10}%&lt;/text&gt;`</span>;
}</code></pre>
                            </div>
                        </div>

                        <div
                            @click="barStep = Math.max(barStep, 2); updateBarPreview()"
                            :class="barStep >= 2 ? 'border-neon-green/50 bg-neon-green/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-green/20 text-neon-green flex items-center justify-center text-sm">2</span>
                                <h3 class="text-lg">Create Dot Grid for Each Bar</h3>
                            </div>
                            <p class="text-white/60 mb-4">Fill bar area with evenly spaced background dots.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="barStep >= 2">
<pre><code><span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> x = startX; x < startX + width; x += spacing) {
  <span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> y = barY; y < barY + barHeight; y += spacing) {
    svg += <span class="highlight-string">`&lt;circle cx="\${x}" cy="\${y}"
      r="3" fill="rgba(255,255,255,0.08)"/&gt;`</span>;
  }
}</code></pre>
                            </div>
                        </div>

                        <div
                            @click="barStep = Math.max(barStep, 3); updateBarPreview()"
                            :class="barStep >= 3 ? 'border-neon-magenta/50 bg-neon-magenta/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-magenta/20 text-neon-magenta flex items-center justify-center text-sm">3</span>
                                <h3 class="text-lg">Fill Dots with Neon Color</h3>
                            </div>
                            <p class="text-white/60 mb-4">Color dots up to the fill percentage with deterministic glow.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="barStep >= 3">
<pre><code><span class="highlight-keyword">const</span> fillWidth = (percent / <span class="highlight-number">100</span>) * chartWidth;

<span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> x = startX; x < startX + fillWidth; x += spacing) {
  <span class="highlight-keyword">const</span> opacity = <span class="highlight-number">0.4</span> + noise(x, y) * <span class="highlight-number">0.5</span>;
  <span class="highlight-keyword">const</span> size = <span class="highlight-number">3</span> * (<span class="highlight-number">0.8</span> + noise(y, x) * <span class="highlight-number">0.4</span>);

  svg += <span class="highlight-string">`&lt;circle cx="\${x}" cy="\${y}"
    r="\${size}" fill="\${color}"
    opacity="\${opacity}"
    style="filter: drop-shadow(0 0 2px \${color})"/&gt;`</span>;
}</code></pre>
                            </div>
                        </div>

                        <div
                            @click="barStep = Math.max(barStep, 4); updateBarPreview()"
                            :class="barStep >= 4 ? 'border-neon-orange/50 bg-neon-orange/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-orange/20 text-neon-orange flex items-center justify-center text-sm">4</span>
                                <h3 class="text-lg">Add Glowing Outline</h3>
                            </div>
                            <p class="text-white/60 mb-4">Subtle glow border around filled portion.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="barStep >= 4">
<pre><code><span class="highlight-comment">// Background outline</span>
svg += <span class="highlight-string">`&lt;rect x="\${startX}" y="\${y}"
  width="\${chartWidth}" height="\${barHeight}"
  fill="none" stroke="rgba(255,255,255,0.1)" rx="4"/&gt;`</span>;

<span class="highlight-comment">// Glowing fill outline</span>
svg += <span class="highlight-string">`&lt;rect x="\${startX}" y="\${y}"
  width="\${fillWidth}" height="\${barHeight}"
  fill="none" stroke="\${color}"
  opacity="0.3" rx="4"
  filter="url(#barGlow)"/&gt;`</span>;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Stacked Chart -->
            <section x-show="currentSection === 4" x-cloak class="step-appear">
                <div class="grid lg:grid-cols-2 gap-12 items-start">
                    <!-- Live Preview -->
                    <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 glow-box sticky top-24">
                        <h3 class="text-neon-green text-sm uppercase tracking-widest mb-6">Live Preview</h3>
                        <div x-html="stackedPreviewSvg"></div>

                        <div class="mt-8" x-show="stackedStep >= 3">
                            <label class="text-white/50 text-sm mb-2 block">Animation progress:</label>
                            <input type="range" min="0" max="1" step="0.01" x-model="stackedProgress" @input="updateStackedPreview()" class="w-full accent-neon-cyan">
                        </div>
                    </div>

                    <!-- Steps -->
                    <div class="space-y-6">
                        <h2 class="text-2xl font-light text-neon-cyan glow-text">Building the Stacked Chart</h2>

                        <div
                            @click="stackedStep = Math.max(stackedStep, 1); updateStackedPreview()"
                            :class="stackedStep >= 1 ? 'border-neon-cyan/50 bg-neon-cyan/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-cyan/20 text-neon-cyan flex items-center justify-center text-sm">1</span>
                                <h3 class="text-lg">Draw Grid Lines & Scale</h3>
                            </div>
                            <p class="text-white/60 mb-4">Add horizontal guides and percentage labels.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="stackedStep >= 1">
<pre><code><span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> i = <span class="highlight-number">0</span>; i <= <span class="highlight-number">4</span>; i++) {
  <span class="highlight-keyword">const</span> y = startY + (i / <span class="highlight-number">4</span>) * chartHeight;
  svg += <span class="highlight-string">`&lt;line x1="\${startX}" y1="\${y}"
    x2="\${startX + chartWidth}" y2="\${y}" /&gt;`</span>;
  svg += <span class="highlight-string">`&lt;text x="\${startX - 12}" y="\${y + 3}"&gt;\${100 - i*25}%&lt;/text&gt;`</span>;
}</code></pre>
                            </div>
                        </div>

                        <div
                            @click="stackedStep = Math.max(stackedStep, 2); updateStackedPreview()"
                            :class="stackedStep >= 2 ? 'border-neon-green/50 bg-neon-green/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-green/20 text-neon-green flex items-center justify-center text-sm">2</span>
                                <h3 class="text-lg">Create Background Dot Grid</h3>
                            </div>
                            <p class="text-white/60 mb-4">Fill each column area with subtle dots.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="stackedStep >= 2">
<pre><code><span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> x = colX; x <= colX + colWidth; x += dotSpacing) {
  <span class="highlight-keyword">for</span> (<span class="highlight-keyword">let</span> y = colY; y <= colY + chartHeight; y += dotSpacing) {
    svg += <span class="highlight-string">`&lt;circle cx="\${x}" cy="\${y}" r="3" /&gt;`</span>;
  }
}</code></pre>
                            </div>
                        </div>

                        <div
                            @click="stackedStep = Math.max(stackedStep, 3); updateStackedPreview()"
                            :class="stackedStep >= 3 ? 'border-neon-magenta/50 bg-neon-magenta/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-magenta/20 text-neon-magenta flex items-center justify-center text-sm">3</span>
                                <h3 class="text-lg">Fill Stacked Segments</h3>
                            </div>
                            <p class="text-white/60 mb-4">Use deterministic noise for consistent neon fill.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="stackedStep >= 3">
<pre><code><span class="highlight-keyword">const</span> opacity = <span class="highlight-number">0.4</span> + noise(x, y) * <span class="highlight-number">0.5</span>;
<span class="highlight-keyword">const</span> size = <span class="highlight-number">3</span> * (<span class="highlight-number">0.8</span> + noise(y, x) * <span class="highlight-number">0.4</span>);
svg += <span class="highlight-string">`&lt;circle cx="\${x}" cy="\${y}" r="\${size}" /&gt;`</span>;</code></pre>
                            </div>
                        </div>

                        <div
                            @click="stackedStep = Math.max(stackedStep, 4); updateStackedPreview()"
                            :class="stackedStep >= 4 ? 'border-neon-orange/50 bg-neon-orange/5' : 'border-white/10'"
                            class="p-6 rounded-xl border cursor-pointer transition-all"
                        >
                            <div class="flex items-center gap-3 mb-4">
                                <span class="w-8 h-8 rounded-full bg-neon-orange/20 text-neon-orange flex items-center justify-center text-sm">4</span>
                                <h3 class="text-lg">Add Outline + Glow</h3>
                            </div>
                            <p class="text-white/60 mb-4">Frame each column and glow the filled portion.</p>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto" x-show="stackedStep >= 4">
<pre><code>svg += <span class="highlight-string">`&lt;rect x="\${colX}" y="\${colY}"
  width="\${colWidth}" height="\${chartHeight}" /&gt;`</span>;
svg += <span class="highlight-string">`&lt;rect x="\${colX}" y="\${fillY}"
  width="\${colWidth}" height="\${fillHeight}" /&gt;`</span>;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Color System -->
            <section x-show="currentSection === 5" x-cloak class="step-appear">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-light text-neon-cyan glow-text mb-8 text-center">The Neon Color System</h2>

                    <div class="grid md:grid-cols-2 gap-8 mb-12">
                        <!-- Color by percentage -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-6">Color Based on Usage</h3>
                            <div class="space-y-4">
                                <div class="flex items-center gap-4">
                                    <div class="w-4 h-4 rounded-full bg-neon-green animate-pulse-glow text-neon-green"></div>
                                    <span class="text-white/60">0-40%</span>
                                    <span class="text-neon-green ml-auto font-mono">#00ff88</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <div class="w-4 h-4 rounded-full bg-neon-cyan animate-pulse-glow text-neon-cyan"></div>
                                    <span class="text-white/60">40-70%</span>
                                    <span class="text-neon-cyan ml-auto font-mono">#00d4ff</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <div class="w-4 h-4 rounded-full bg-neon-magenta animate-pulse-glow text-neon-magenta"></div>
                                    <span class="text-white/60">70-90%</span>
                                    <span class="text-neon-magenta ml-auto font-mono">#ff00ff</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <div class="w-4 h-4 rounded-full bg-neon-orange animate-pulse-glow text-neon-orange"></div>
                                    <span class="text-white/60">90-100%</span>
                                    <span class="text-neon-orange ml-auto font-mono">#ffaa00</span>
                                </div>
                            </div>
                        </div>

                        <!-- Code -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-6">Implementation</h3>
                            <div class="code-block rounded-lg p-4 text-sm">
<pre><code><span class="highlight-keyword">function</span> <span class="highlight-function">getColor</span>(percent) {
  <span class="highlight-keyword">if</span> (percent >= <span class="highlight-number">90</span>) <span class="highlight-keyword">return</span> <span class="highlight-string">'#ffaa00'</span>;
  <span class="highlight-keyword">if</span> (percent >= <span class="highlight-number">70</span>) <span class="highlight-keyword">return</span> <span class="highlight-string">'#ff00ff'</span>;
  <span class="highlight-keyword">if</span> (percent >= <span class="highlight-number">40</span>) <span class="highlight-keyword">return</span> <span class="highlight-string">'#00d4ff'</span>;
  <span class="highlight-keyword">return</span> <span class="highlight-string">'#00ff88'</span>;
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive demo -->
                    <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                        <h3 class="text-lg mb-6 text-center">Try It - Drag the Slider</h3>
                        <div class="flex flex-col items-center gap-6">
                            <div
                                class="w-32 h-32 rounded-full flex items-center justify-center text-3xl font-light transition-all duration-300"
                                :style="`background: ${getColor(colorDemo)}20; border: 2px solid ${getColor(colorDemo)}; box-shadow: 0 0 30px ${getColor(colorDemo)}50; color: ${getColor(colorDemo)};`"
                                x-text="colorDemo + '%'"
                            ></div>
                            <input type="range" min="0" max="100" x-model="colorDemo" class="w-64 accent-neon-cyan">
                            <div class="text-white/60 font-mono" x-text="getColor(colorDemo)"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Glow Effects -->
            <section x-show="currentSection === 6" x-cloak class="step-appear">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-light text-neon-cyan glow-text mb-8 text-center">Creating Glow Effects</h2>

                    <div class="grid gap-8">
                        <!-- SVG Filter -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-4 text-neon-green">1. SVG Blur Filter</h3>
                            <p class="text-white/60 mb-6">Use feGaussianBlur for soft glow on shapes.</p>
                            <div class="grid md:grid-cols-2 gap-8 items-center">
                                <div class="code-block rounded-lg p-4 text-sm">
<pre><code><span class="highlight-string">&lt;defs&gt;
  &lt;filter id="glow"&gt;
    &lt;feGaussianBlur
      stdDeviation="3"
      result="blur"/&gt;
    &lt;feMerge&gt;
      &lt;feMergeNode in="blur"/&gt;
      &lt;feMergeNode in="SourceGraphic"/&gt;
    &lt;/feMerge&gt;
  &lt;/filter&gt;
&lt;/defs&gt;

&lt;path ... filter="url(#glow)"/&gt;</span></code></pre>
                                </div>
                                <div class="flex justify-center gap-8">
                                    <div class="text-center">
                                        <svg width="80" height="80">
                                            <circle cx="40" cy="40" r="30" fill="#00d4ff"/>
                                        </svg>
                                        <p class="text-white/40 text-sm mt-2">Without</p>
                                    </div>
                                    <div class="text-center">
                                        <svg width="80" height="80">
                                            <defs>
                                                <filter id="demoGlow">
                                                    <feGaussianBlur stdDeviation="4" result="blur"/>
                                                    <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                                                </filter>
                                            </defs>
                                            <circle cx="40" cy="40" r="30" fill="#00d4ff" filter="url(#demoGlow)"/>
                                        </svg>
                                        <p class="text-white/40 text-sm mt-2">With Filter</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CSS drop-shadow -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-4 text-neon-magenta">2. CSS drop-shadow for Dots</h3>
                            <p class="text-white/60 mb-6">Inline style for individual dot glow.</p>
                            <div class="grid md:grid-cols-2 gap-8 items-center">
                                <div class="code-block rounded-lg p-4 text-sm">
<pre><code><span class="highlight-string">&lt;circle
  cx="50" cy="50" r="5"
  fill="#ff00ff"
  style="filter: drop-shadow(0 0 3px #ff00ff)"
/&gt;</span></code></pre>
                                </div>
                                <div class="flex justify-center gap-8">
                                    <div class="text-center">
                                        <svg width="80" height="80">
                                            <circle cx="40" cy="40" r="8" fill="#ff00ff"/>
                                        </svg>
                                        <p class="text-white/40 text-sm mt-2">Without</p>
                                    </div>
                                    <div class="text-center">
                                        <svg width="80" height="80">
                                            <circle cx="40" cy="40" r="8" fill="#ff00ff" style="filter: drop-shadow(0 0 5px #ff00ff)"/>
                                        </svg>
                                        <p class="text-white/40 text-sm mt-2">With drop-shadow</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Text shadow -->
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-4 text-neon-orange">3. Text Shadow for Labels</h3>
                            <p class="text-white/60 mb-6">CSS text-shadow creates the neon text effect.</p>
                            <div class="grid md:grid-cols-2 gap-8 items-center">
                                <div class="code-block rounded-lg p-4 text-sm">
<pre><code><span class="highlight-string">&lt;text
  style="text-shadow: 0 0 15px #ffaa0080;"
&gt;
  65%
&lt;/text&gt;</span></code></pre>
                                </div>
                                <div class="flex justify-center gap-8">
                                    <div class="text-center">
                                        <span class="text-4xl text-neon-orange">65%</span>
                                        <p class="text-white/40 text-sm mt-2">Without</p>
                                    </div>
                                    <div class="text-center">
                                        <span class="text-4xl text-neon-orange glow-text">65%</span>
                                        <p class="text-white/40 text-sm mt-2">With text-shadow</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Sparkle -->
            <section x-show="currentSection === 7" x-cloak class="step-appear">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-light text-neon-cyan glow-text mb-8 text-center">Sparkle Refresh</h2>
                    <p class="text-white/50 text-center mb-12">The shimmer comes from re-seeding deterministic noise at a steady interval.</p>

                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-4 text-neon-green">How It Works</h3>
                            <div class="space-y-3 text-sm text-white/60">
                                <p>Each dot uses a noise function based on its coordinates.</p>
                                <p>On every tick, the noise seed changes, nudging opacity and size.</p>
                                <p>The result is a subtle shimmer without random popping.</p>
                            </div>
                        </div>

                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10 flex flex-col items-center">
                            <h3 class="text-lg mb-4 text-neon-green">Live Sparkle</h3>
                            <div class="mt-2" x-html="sparkleDemoSvg"></div>
                            <p class="text-white/40 text-xs mt-4">Square dot field, re-seeded every tick.</p>
                        </div>

                        <div class="bg-dark-800 rounded-2xl p-8 border border-white/10">
                            <h3 class="text-lg mb-4 text-neon-green">Implementation</h3>
                            <div class="code-block rounded-lg p-4 text-sm overflow-x-auto">
<pre><code><span class="highlight-comment">// Tick forward on a timer</span>
sparkleTick = (sparkleTick + <span class="highlight-number">1</span>) % <span class="highlight-number">100000</span>;

<span class="highlight-comment">// Deterministic noise with a time seed</span>
<span class="highlight-keyword">function</span> <span class="highlight-function">noise</span>(a, b, seed) {
  <span class="highlight-keyword">const</span> x = Math.<span class="highlight-function">sin</span>((a + seed) * <span class="highlight-number">12.9898</span> + (b - seed) * <span class="highlight-number">78.233</span>) * <span class="highlight-number">43758.5453</span>;
  <span class="highlight-keyword">return</span> x - Math.<span class="highlight-function">floor</span>(x);
}

opacity = <span class="highlight-number">0.4</span> + noise(x, y, sparkleTick) * <span class="highlight-number">0.5</span>;
size = <span class="highlight-number">1.5</span> + noise(y, x, sparkleTick) * <span class="highlight-number">0.6</span>;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="relative z-10 py-8 border-t border-white/10 text-center text-white/40 text-sm">
            <p>Built with vanilla SVG, Tailwind CSS, and Alpine.js</p>
        </footer>
    </div>

    <script>
        function tutorial() {
            return {
                currentSection: 0,
                sections: [
                    { title: 'Full Preview' },
                    { title: 'Full Preview (Interactive)' },
                    { title: 'Radial Chart' },
                    { title: 'Bar Chart' },
                    { title: 'Stacked Chart' },
                    { title: 'Color System' },
                    { title: 'Glow Effects' },
                    { title: 'Sparkle' }
                ],

                // Radial chart state
                maxRadialPercent: 1,
                fullPreviewPercent: 49,
                fullPreviewColor: '#00d4ff',
                fullPreviewSize: 180,
                fullPreviewSvg: '',
                interactivePreviewPercent: 49,
                interactivePreviewColor: '#00d4ff',
                interactivePreviewSize: 180,
                interactivePreviewSvg: '',
                radialPreviewSvg: '',
                radialStep: 0,
                radialProgress: 0.49,
                backgroundDots: [],
                filledDots: [],

                // Bar chart state
                barStep: 0,
                barProgress: 1,
                barBgDots1: [],
                barBgDots2: [],
                barFillDots1: [],
                barFillDots2: [],
                barPreviewSvg: '',
                stackedStep: 0,
                stackedProgress: 1,
                stackedPreviewSvg: '',
                sparkleTick: 0,
                sparkleIntervalMs: 400,
                sparkleDemoSvg: '',

                // Color demo
                colorDemo: 45,

                init() {
                    this.fullPreviewSvg = this.createRadialChart(
                        this.fullPreviewPercent,
                        this.fullPreviewColor,
                        this.fullPreviewSize,
                        0
                    );
                    this.interactivePreviewSvg = this.createRadialChart(
                        this.interactivePreviewPercent,
                        this.interactivePreviewColor,
                        this.interactivePreviewSize,
                        this.sparkleTick
                    );
                    this.updateRadialPreview();
                    this.updateBarPreview();
                    this.updateStackedPreview();
                    this.updateSparkleDemo();
                    this.generateRadialDots();
                    this.generateBarDots();

                    setInterval(() => {
                        this.sparkleTick = (this.sparkleTick + 1) % 100000;
                        this.refreshSparkle();
                    }, this.sparkleIntervalMs);
                },

                generateRadialDots() {
                    const centerX = 150, centerY = 150;
                    const outerRadius = 125, innerRadius = outerRadius - 30;
                    const dotSpacing = 7;
                    let id = 0;

                    for (let r = innerRadius + 6; r < outerRadius - 4; r += dotSpacing) {
                        const circumference = 2 * Math.PI * r;
                        const angleStep = (dotSpacing / circumference) * 360;

                        for (let angle = -90; angle < 270; angle += angleStep) {
                            const rad = angle * Math.PI / 180;
                            const x = centerX + r * Math.cos(rad);
                            const y = centerY + r * Math.sin(rad);

                            this.backgroundDots.push({ id: id++, x, y });

                            this.filledDots.push({
                                id: id++,
                                x, y,
                                angle,
                                opacity: 0.4 + Math.random() * 0.5,
                                size: 1.5 + Math.random() * 0.6
                            });
                        }
                    }
                },

                generateBarDots() {
                    const startX = 105, barHeight = 50, spacing = 8;
                    let id = 0;

                    // Bar 1
                    for (let x = startX; x < 460; x += spacing) {
                        for (let y = 35; y < 75; y += spacing) {
                            this.barBgDots1.push({ id: id++, x, y });
                            if (x < startX + 360 * 0.65) {
                                this.barFillDots1.push({
                                    id: id++, x, y,
                                    opacity: 0.4 + Math.random() * 0.5,
                                    size: 3 * (0.8 + Math.random() * 0.4)
                                });
                            }
                        }
                    }

                    // Bar 2
                    for (let x = startX; x < 460; x += spacing) {
                        for (let y = 105; y < 145; y += spacing) {
                            this.barBgDots2.push({ id: id++, x, y });
                            if (x < startX + 360 * 0.41) {
                                this.barFillDots2.push({
                                    id: id++, x, y,
                                    opacity: 0.4 + Math.random() * 0.5,
                                    size: 3 * (0.8 + Math.random() * 0.4)
                                });
                            }
                        }
                    }
                },

                updateInteractivePreview() {
                    this.interactivePreviewSvg = this.createRadialChart(
                        this.interactivePreviewPercent,
                        this.interactivePreviewColor,
                        this.interactivePreviewSize,
                        this.sparkleTick
                    );
                },

                updateRadialPreview() {
                    const percent = Math.round(this.radialProgress * 100);
                    this.radialPreviewSvg = this.createRadialChartWithSteps(
                        percent,
                        '#00d4ff',
                        300,
                        this.radialStep,
                        this.sparkleTick
                    );
                },

                updateBarPreview() {
                    this.barPreviewSvg = this.createBarChartWithSteps(this.barStep, this.barProgress, this.sparkleTick);
                },

                updateStackedPreview() {
                    this.stackedPreviewSvg = this.createStackedChartWithSteps(this.stackedStep, this.stackedProgress, this.sparkleTick);
                },

                updateSparkleDemo() {
                    this.sparkleDemoSvg = this.createSparkleGrid(160, 10, this.sparkleTick);
                },

                createBarChartWithSteps(step, progress, sparkleSeed) {
                    const width = 500;
                    const height = 200;
                    const startX = 100;
                    const chartWidth = 360;
                    const barHeight = 50;
                    const spacing = 8;

                    const bars = [
                        { y: 30, label: '5-Hour', percent: 65, color: '#00ff88' },
                        { y: 100, label: '7-Day', percent: 41, color: '#00d4ff' }
                    ];

                    let svg = `<svg width="100%" height="${height}" viewBox="0 0 ${width} ${height}" style="overflow: visible;">`;
                    svg += `
                        <defs>
                            <filter id="barGlow">
                                <feGaussianBlur stdDeviation="3" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                        </defs>
                    `;

                    if (step >= 1) {
                        for (let i = 0; i <= 10; i++) {
                            const x = startX + (i / 10) * chartWidth;
                            svg += `<line x1="${x}" y1="20" x2="${x}" y2="160" stroke="rgba(255,255,255,0.05)"/>`;
                            svg += `<text x="${x}" y="180" text-anchor="middle" fill="rgba(255,255,255,0.4)" font-size="10">${i * 10}%</text>`;
                        }
                    }

                    for (const bar of bars) {
                        const fillWidth = chartWidth * (bar.percent / 100) * progress;
                        svg += `<text x="90" y="${bar.y + 25}" text-anchor="end" fill="rgba(255,255,255,0.8)" font-size="12">${bar.label}</text>`;

                        if (step >= 2) {
                            for (let x = startX; x < startX + chartWidth; x += spacing) {
                                for (let y = bar.y + 5; y < bar.y + barHeight - 5; y += spacing) {
                                    svg += `<circle cx="${x}" cy="${y}" r="3" fill="rgba(255,255,255,0.08)"/>`;
                                }
                            }
                        }

                        if (step >= 3) {
                            for (let x = startX + 2; x < startX + fillWidth - 2; x += spacing) {
                                    for (let y = bar.y + 5; y < bar.y + barHeight - 5; y += spacing) {
                                    const opacity = 0.4 + this._noise(x, y, sparkleSeed) * 0.5;
                                    const size = 3 * (0.8 + this._noise(y, x, sparkleSeed) * 0.4);
                                    svg += `<circle cx="${x}" cy="${y}" r="${size}" fill="${bar.color}" opacity="${opacity}" style="filter: drop-shadow(0 0 2px ${bar.color})"/>`;
                                }
                            }
                        }

                        if (step >= 4) {
                            svg += `<rect x="${startX}" y="${bar.y}" width="${chartWidth}" height="${barHeight}" fill="none" stroke="rgba(255,255,255,0.1)" rx="4"/>`;
                            svg += `<rect x="${startX}" y="${bar.y}" width="${fillWidth}" height="${barHeight}" fill="none" stroke="${bar.color}" stroke-width="1" opacity="0.3" rx="4" filter="url(#barGlow)"/>`;
                        }
                    }

                    svg += '</svg>';
                    return svg;
                },

                createStackedChartWithSteps(step, progress, sparkleSeed) {
                    const width = 500;
                    const height = 240;
                    const chartWidth = 360;
                    const chartHeight = 160;
                    const startX = 100;
                    const startY = 40;
                    const columnGap = 30;
                    const columnWidth = 70;
                    const dotSpacing = 8;

                    const columns = [
                        {
                            label: '5-Hour',
                            segments: [
                                { percent: 40, color: '#00ff88' },
                                { percent: 9, color: '#00d4ff' }
                            ]
                        },
                        {
                            label: '7-Day',
                            segments: [
                                { percent: 55, color: '#00d4ff' },
                                { percent: 18, color: '#ff00ff' }
                            ]
                        },
                        {
                            label: '30-Day',
                            segments: [
                                { percent: 62, color: '#00d4ff' },
                                { percent: 25, color: '#ffaa00' }
                            ]
                        }
                    ];

                    let svg = `<svg width="100%" height="${height}" viewBox="0 0 ${width} ${height}" style="overflow: visible;">`;
                    svg += `
                        <defs>
                            <filter id="stackGlow">
                                <feGaussianBlur stdDeviation="3" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                        </defs>
                    `;

                    if (step >= 1) {
                        for (let i = 0; i <= 4; i++) {
                            const y = startY + (i / 4) * chartHeight;
                            svg += `<line x1="${startX - 10}" y1="${y}" x2="${startX + chartWidth}" y2="${y}" stroke="rgba(255,255,255,0.05)"/>`;
                            svg += `<text x="${startX - 18}" y="${y + 3}" text-anchor="end" fill="rgba(255,255,255,0.4)" font-size="10">${(100 - i * 25)}%</text>`;
                        }
                    }

                    columns.forEach((column, index) => {
                        const colX = startX + index * (columnWidth + columnGap);
                        const colY = startY;

                        svg += `<text x="${colX + columnWidth / 2}" y="${startY + chartHeight + 22}" text-anchor="middle" fill="rgba(255,255,255,0.7)" font-size="11">${column.label}</text>`;

                        if (step >= 2) {
                            for (let x = colX; x <= colX + columnWidth; x += dotSpacing) {
                                for (let y = colY; y <= colY + chartHeight; y += dotSpacing) {
                                    svg += `<circle cx="${x}" cy="${y}" r="3" fill="rgba(255,255,255,0.08)"/>`;
                                }
                            }
                        }

                        if (step >= 3) {
                            let filledHeight = 0;
                            column.segments.forEach(segment => {
                                const segHeight = chartHeight * (segment.percent / 100);
                                const segStart = colY + chartHeight - filledHeight - segHeight;
                                const segEnd = colY + chartHeight - filledHeight;
                                const visibleEnd = segStart + (segHeight * progress);

                                for (let x = colX + 2; x <= colX + columnWidth - 2; x += dotSpacing) {
                                    for (let y = segEnd - 2; y >= segStart; y -= dotSpacing) {
                                        if (y < visibleEnd) {
                                            const opacity = 0.4 + this._noise(x, y, sparkleSeed) * 0.5;
                                            const size = 3 * (0.8 + this._noise(y, x, sparkleSeed) * 0.4);
                                            svg += `<circle cx="${x}" cy="${y}" r="${size}" fill="${segment.color}" opacity="${opacity}" style="filter: drop-shadow(0 0 2px ${segment.color})"/>`;
                                        }
                                    }
                                }

                                filledHeight += segHeight;
                            });
                        }

                        if (step >= 4) {
                            svg += `<rect x="${colX}" y="${colY}" width="${columnWidth}" height="${chartHeight}" fill="none" stroke="rgba(255,255,255,0.1)" rx="6"/>`;
                            const totalPercent = column.segments.reduce((sum, seg) => sum + seg.percent, 0);
                            const fillHeight = chartHeight * (totalPercent / 100) * progress;
                            svg += `<rect x="${colX}" y="${colY + chartHeight - fillHeight}" width="${columnWidth}" height="${fillHeight}" fill="none" stroke="${column.segments[0].color}" stroke-width="1" opacity="0.3" rx="6" filter="url(#stackGlow)"/>`;
                        }
                    });

                    svg += '</svg>';
                    return svg;
                },

                createRadialChartWithSteps(percent, color, size, step, sparkleSeed) {
                    const centerX = size / 2;
                    const centerY = size / 2;
                    const outerRadius = size / 2 - 25;
                    const innerRadius = outerRadius - 30;

                    let svg = `<svg width="${size}" height="${size}" style="overflow: visible;">`;

                    svg += `
                        <defs>
                            <filter id="rglow-step" x="-50%" y="-50%" width="200%" height="200%">
                                <feGaussianBlur stdDeviation="3" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                            <radialGradient id="rambient-step">
                                <stop offset="0%" stop-color="${color}" stop-opacity="0.1"/>
                                <stop offset="100%" stop-color="#000000" stop-opacity="0"/>
                            </radialGradient>
                        </defs>
                    `;

                    if (step >= 1) {
                        svg += `<circle cx="${centerX}" cy="${centerY}" r="${outerRadius + 2}" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>`;
                        svg += `<circle cx="${centerX}" cy="${centerY}" r="${innerRadius - 2}" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>`;
                        svg += `<line x1="${centerX}" y1="${centerY - outerRadius - 2}" x2="${centerX}" y2="${centerY + outerRadius + 2}" stroke="rgba(255,255,255,0.05)"/>`;
                        svg += `<line x1="${centerX - outerRadius - 2}" y1="${centerY}" x2="${centerX + outerRadius + 2}" y2="${centerY}" stroke="rgba(255,255,255,0.05)"/>`;
                        svg += `<text x="${centerX}" y="${centerY - outerRadius - 10}" text-anchor="middle" fill="rgba(255,255,255,0.35)" font-size="10">0%</text>`;
                        svg += `<text x="${centerX + outerRadius + 10}" y="${centerY + 4}" text-anchor="middle" fill="rgba(255,255,255,0.35)" font-size="10">25%</text>`;
                        svg += `<text x="${centerX}" y="${centerY + outerRadius + 16}" text-anchor="middle" fill="rgba(255,255,255,0.35)" font-size="10">50%</text>`;
                        svg += `<text x="${centerX - outerRadius - 10}" y="${centerY + 4}" text-anchor="middle" fill="rgba(255,255,255,0.35)" font-size="10">75%</text>`;
                    }

                    if (step >= 2) {
                        svg += `<circle cx="${centerX}" cy="${centerY}" r="${outerRadius - 8}" fill="url(#rambient-step)" opacity="0.5"/>`;
                    }

                    const dotSpacing = 7;
                    const fillEndAngle = -90 + (percent / 100) * 360;

                    if (step >= 2) {
                        for (let r = innerRadius + 6; r < outerRadius - 4; r += dotSpacing) {
                            const circumference = 2 * Math.PI * r;
                            const angleStep = (dotSpacing / circumference) * 360;
                            for (let angle = -90; angle < 270; angle += angleStep) {
                                const rad = angle * Math.PI / 180;
                                const x = centerX + r * Math.cos(rad);
                                const y = centerY + r * Math.sin(rad);
                                svg += `<circle cx="${x}" cy="${y}" r="1.5" fill="rgba(255,255,255,0.08)"/>`;
                            }
                        }
                    }

                    if (step >= 3) {
                        for (let r = innerRadius + 6; r < outerRadius - 4; r += dotSpacing) {
                            const circumference = 2 * Math.PI * r;
                            const angleStep = (dotSpacing / circumference) * 360;
                            for (let angle = -90; angle < fillEndAngle - 2; angle += angleStep) {
                                const rad = angle * Math.PI / 180;
                                const x = centerX + r * Math.cos(rad);
                                const y = centerY + r * Math.sin(rad);
                                const opacity = 0.4 + this._noise(r, angle, sparkleSeed) * 0.5;
                                const dotSize = 1.5 + this._noise(angle, r, sparkleSeed) * 0.6;
                                svg += `<circle cx="${x}" cy="${y}" r="${dotSize}" fill="${color}" opacity="${opacity}" style="filter: drop-shadow(0 0 2px ${color})"/>`;
                            }
                        }
                    }

                    if (step >= 4 && percent > 0) {
                        const startRad = -90 * Math.PI / 180;
                        const endRad = fillEndAngle * Math.PI / 180;
                        const largeArc = percent > 50 ? 1 : 0;

                        const ox1 = centerX + outerRadius * Math.cos(startRad);
                        const oy1 = centerY + outerRadius * Math.sin(startRad);
                        const ox2 = centerX + outerRadius * Math.cos(endRad);
                        const oy2 = centerY + outerRadius * Math.sin(endRad);

                        svg += `<path d="M ${ox1} ${oy1} A ${outerRadius} ${outerRadius} 0 ${largeArc} 1 ${ox2} ${oy2}" fill="none" stroke="${color}" stroke-width="1.5" opacity="0.6" filter="url(#rglow-step)"/>`;

                        const ix1 = centerX + innerRadius * Math.cos(startRad);
                        const iy1 = centerY + innerRadius * Math.sin(startRad);
                        const ix2 = centerX + innerRadius * Math.cos(endRad);
                        const iy2 = centerY + innerRadius * Math.sin(endRad);

                        svg += `<path d="M ${ix1} ${iy1} A ${innerRadius} ${innerRadius} 0 ${largeArc} 1 ${ix2} ${iy2}" fill="none" stroke="${color}" stroke-width="0.5" opacity="0.4"/>`;
                        svg += `<line x1="${centerX + innerRadius * Math.cos(startRad)}" y1="${centerY + innerRadius * Math.sin(startRad)}" x2="${centerX + outerRadius * Math.cos(startRad)}" y2="${centerY + outerRadius * Math.sin(startRad)}" stroke="${color}" stroke-width="1" opacity="0.3"/>`;
                        svg += `<line x1="${centerX + innerRadius * Math.cos(endRad)}" y1="${centerY + innerRadius * Math.sin(endRad)}" x2="${centerX + outerRadius * Math.cos(endRad)}" y2="${centerY + outerRadius * Math.sin(endRad)}" stroke="${color}" stroke-width="1" opacity="0.5"/>`;
                    }

                    if (step >= 5) {
                        svg += `<text x="${centerX}" y="${centerY - 2}" text-anchor="middle" fill="#ffffff" font-size="36" font-weight="200" style="text-shadow: 0 0 15px ${color}80;">${percent}%</text>`;
                        svg += `<text x="${centerX}" y="${centerY + 14}" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-size="11" letter-spacing="2">USED</text>`;
                    }

                    svg += '</svg>';
                    return svg;
                },

                refreshSparkle() {
                    this.updateInteractivePreview();
                    this.updateRadialPreview();
                    this.updateBarPreview();
                    this.updateStackedPreview();
                    this.updateSparkleDemo();
                },

                _noise(a, b, seed = 0) {
                    const x = Math.sin((a + seed) * 12.9898 + (b - seed) * 78.233) * 43758.5453;
                    return x - Math.floor(x);
                },

                createSparkleGrid(size, spacing, sparkleSeed) {
                    let svg = `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" style="overflow: visible;">`;
                    svg += `<rect x="0" y="0" width="${size}" height="${size}" fill="rgba(255,255,255,0.02)" rx="12"/>`;
                    for (let x = spacing; x < size - spacing; x += spacing) {
                        for (let y = spacing; y < size - spacing; y += spacing) {
                            const opacity = 0.4 + this._noise(x, y, sparkleSeed) * 0.5;
                            const dotSize = 1.5 + this._noise(y, x, sparkleSeed) * 0.6;
                            svg += `<circle cx="${x}" cy="${y}" r="${dotSize}" fill="#00d4ff" opacity="${opacity}" style="filter: drop-shadow(0 0 2px #00d4ff)"/>`;
                        }
                    }
                    svg += '</svg>';
                    return svg;
                },

                createRadialChart(percent, color, size = 180, sparkleSeed = 0) {
                    const centerX = size / 2;
                    const centerY = size / 2;
                    const outerRadius = size / 2 - 15;
                    const innerRadius = outerRadius - 30;

                    let svg = `<svg width="${size}" height="${size}" style="overflow: visible;">`;

                    svg += `
                        <defs>
                            <filter id="rglow-${percent}" x="-50%" y="-50%" width="200%" height="200%">
                                <feGaussianBlur stdDeviation="3" result="blur"/>
                                <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                            <radialGradient id="rambient-${percent}">
                                <stop offset="0%" stop-color="${color}" stop-opacity="0.1"/>
                                <stop offset="100%" stop-color="#000000" stop-opacity="0"/>
                            </radialGradient>
                        </defs>
                    `;

                    // Ambient glow
                    svg += `<circle cx="${centerX}" cy="${centerY}" r="${outerRadius - 8}" fill="url(#rambient-${percent})" opacity="0.5"/>`;

                    // Rings
                    svg += `<circle cx="${centerX}" cy="${centerY}" r="${outerRadius + 2}" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>`;
                    svg += `<circle cx="${centerX}" cy="${centerY}" r="${innerRadius - 2}" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>`;

                    const dotSpacing = 7;
                    const fillEndAngle = -90 + (percent / 100) * 360;

                    // Background dots
                    for (let r = innerRadius + 6; r < outerRadius - 4; r += dotSpacing) {
                        const circumference = 2 * Math.PI * r;
                        const angleStep = (dotSpacing / circumference) * 360;
                        for (let angle = -90; angle < 270; angle += angleStep) {
                            const rad = angle * Math.PI / 180;
                            const x = centerX + r * Math.cos(rad);
                            const y = centerY + r * Math.sin(rad);
                            svg += `<circle cx="${x}" cy="${y}" r="1.5" fill="rgba(255,255,255,0.08)"/>`;
                        }
                    }

                    // Filled dots
                    for (let r = innerRadius + 6; r < outerRadius - 4; r += dotSpacing) {
                        const circumference = 2 * Math.PI * r;
                        const angleStep = (dotSpacing / circumference) * 360;
                            for (let angle = -90; angle < fillEndAngle - 2; angle += angleStep) {
                                const rad = angle * Math.PI / 180;
                                const x = centerX + r * Math.cos(rad);
                                const y = centerY + r * Math.sin(rad);
                                const opacity = 0.4 + this._noise(r, angle, sparkleSeed) * 0.5;
                                const dotSize = 1.5 + this._noise(angle, r, sparkleSeed) * 0.6;
                                svg += `<circle cx="${x}" cy="${y}" r="${dotSize}" fill="${color}" opacity="${opacity}" style="filter: drop-shadow(0 0 2px ${color})"/>`;
                            }
                        }

                    // Arcs
                    if (percent > 0) {
                        const startRad = -90 * Math.PI / 180;
                        const endRad = fillEndAngle * Math.PI / 180;
                        const largeArc = percent > 50 ? 1 : 0;

                        const ox1 = centerX + outerRadius * Math.cos(startRad);
                        const oy1 = centerY + outerRadius * Math.sin(startRad);
                        const ox2 = centerX + outerRadius * Math.cos(endRad);
                        const oy2 = centerY + outerRadius * Math.sin(endRad);

                        svg += `<path d="M ${ox1} ${oy1} A ${outerRadius} ${outerRadius} 0 ${largeArc} 1 ${ox2} ${oy2}" fill="none" stroke="${color}" stroke-width="1.5" opacity="0.6" filter="url(#rglow-${percent})"/>`;

                        const ix1 = centerX + innerRadius * Math.cos(startRad);
                        const iy1 = centerY + innerRadius * Math.sin(startRad);
                        const ix2 = centerX + innerRadius * Math.cos(endRad);
                        const iy2 = centerY + innerRadius * Math.sin(endRad);

                        svg += `<path d="M ${ix1} ${iy1} A ${innerRadius} ${innerRadius} 0 ${largeArc} 1 ${ix2} ${iy2}" fill="none" stroke="${color}" stroke-width="0.5" opacity="0.4"/>`;

                        // Radial lines
                        svg += `<line x1="${centerX + innerRadius * Math.cos(startRad)}" y1="${centerY + innerRadius * Math.sin(startRad)}" x2="${centerX + outerRadius * Math.cos(startRad)}" y2="${centerY + outerRadius * Math.sin(startRad)}" stroke="${color}" stroke-width="1" opacity="0.3"/>`;
                        svg += `<line x1="${centerX + innerRadius * Math.cos(endRad)}" y1="${centerY + innerRadius * Math.sin(endRad)}" x2="${centerX + outerRadius * Math.cos(endRad)}" y2="${centerY + outerRadius * Math.sin(endRad)}" stroke="${color}" stroke-width="1" opacity="0.5"/>`;
                    }

                    // Center text
                    svg += `<text x="${centerX}" y="${centerY - 2}" text-anchor="middle" fill="#ffffff" font-size="26" font-weight="200" style="text-shadow: 0 0 12px ${color}80;">${percent}%</text>`;
                    svg += `<text x="${centerX}" y="${centerY + 14}" text-anchor="middle" fill="rgba(255,255,255,0.4)" font-size="9" letter-spacing="2">USED</text>`;

                    svg += '</svg>';
                    return svg;
                },

                get usageProgress() {
                    return this.radialProgress * this.maxRadialPercent;
                },

                get usagePercent() {
                    return Math.round(this.usageProgress * 100);
                },

                get _arcData() {
                    return this._arcDataFor(this.usageProgress);
                },

                _arcDataFor(progress) {
                    const cx = 150, cy = 150, outerR = 125, innerR = 95;
                    const startRad = -90 * Math.PI / 180;
                    const endAngle = -90 + progress * 360;
                    const endRad = endAngle * Math.PI / 180;
                    const largeArc = progress > 0.5 ? 1 : 0;
                    return { cx, cy, outerR, innerR, startRad, endRad, largeArc };
                },

                get outerArcPath() {
                    const { cx, cy, outerR: r, startRad, endRad, largeArc } = this._arcData;
                    return `M ${cx + r * Math.cos(startRad)} ${cy + r * Math.sin(startRad)} A ${r} ${r} 0 ${largeArc} 1 ${cx + r * Math.cos(endRad)} ${cy + r * Math.sin(endRad)}`;
                },

                get innerArcPath() {
                    const { cx, cy, innerR: r, startRad, endRad, largeArc } = this._arcData;
                    return `M ${cx + r * Math.cos(startRad)} ${cy + r * Math.sin(startRad)} A ${r} ${r} 0 ${largeArc} 1 ${cx + r * Math.cos(endRad)} ${cy + r * Math.sin(endRad)}`;
                },

                // Radial lines at fill start/end
                get startLineX1() { const d = this._arcData; return d.cx + d.innerR * Math.cos(d.startRad); },
                get startLineY1() { const d = this._arcData; return d.cy + d.innerR * Math.sin(d.startRad); },
                get startLineX2() { const d = this._arcData; return d.cx + d.outerR * Math.cos(d.startRad); },
                get startLineY2() { const d = this._arcData; return d.cy + d.outerR * Math.sin(d.startRad); },
                get endLineX1() { const d = this._arcData; return d.cx + d.innerR * Math.cos(d.endRad); },
                get endLineY1() { const d = this._arcData; return d.cy + d.innerR * Math.sin(d.endRad); },
                get endLineX2() { const d = this._arcData; return d.cx + d.outerR * Math.cos(d.endRad); },
                get endLineY2() { const d = this._arcData; return d.cy + d.outerR * Math.sin(d.endRad); },

                get filledDotsByProgress() {
                    const endAngle = -90 + this.usageProgress * 360;
                    return this.filledDots.filter(dot => dot.angle < endAngle - 2);
                },

                getColor(percent) {
                    if (percent >= 90) return '#ffaa00';
                    if (percent >= 70) return '#ff00ff';
                    if (percent >= 40) return '#00d4ff';
                    return '#00ff88';
                }
            }
        }
    </script>
</body>
</html>
